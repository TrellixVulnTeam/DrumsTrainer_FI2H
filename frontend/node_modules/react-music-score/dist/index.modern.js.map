{"version":3,"file":"index.modern.js","sources":["../src/ui/Button.tsx","../src/ui/ToggleButton.tsx","../src/ui/ButtonGroup.tsx","../src/ui/Navbar.tsx","../src/ui/Dropdown.tsx","../src/lib/musicxml.tsx","../src/ui/NoteButton.tsx","../src/lib/notes.ts","../src/lib/scales.ts","../src/MusicXMLSheet.tsx","../src/ScoreEditor.tsx"],"sourcesContent":["import React from 'react';\nimport styles from './Button.module.css';\n\ninterface ButtonProps {\n  children?: any;\n  disabled?: boolean;\n  className?: string;\n  id?: string;\n  onClick?: () => void;\n}\nexport const Button = ({\n  children,\n  disabled,\n  className,\n  id,\n  onClick,\n}: ButtonProps) => {\n  return (\n    <button\n      disabled={disabled}\n      id={id}\n      className={`${styles.button} ${className}`}\n      onClick={onClick}\n    >\n      {children}\n    </button>\n  );\n};\n","import React from 'react';\nimport styles from './ToggleButton.module.css';\n\ninterface ButtonProps {\n  children?: any;\n  className?: string;\n  id?: string;\n  onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\n  checked?: boolean;\n  disabled?: boolean;\n}\nexport const ToggleButton = ({\n  children,\n  className,\n  id,\n  checked,\n  onClick,\n  disabled,\n}: ButtonProps) => {\n  if (checked) {\n    return (\n      <button\n        id={id}\n        className={`${styles.toggleButton} ${styles.checked} ${className}`}\n        onClick={onClick}\n      >\n        {children}\n      </button>\n    );\n  }\n  return (\n    <button\n      id={id}\n      disabled={disabled}\n      className={`${styles.toggleButton} ${className}`}\n      onClick={onClick}\n    >\n      {children}\n    </button>\n  );\n  // return (\n  //   // <div>\n  //   //   <input\n  //   //     disabled={disabled}\n  //   //     type={type}\n  //   //     checked={checked}\n  //   //     className={className}\n  //   //     id={id}\n  //   //     onChange={onChange}\n  //   //     onClick={onClick}\n  //   //     value={value}\n  //   //   />\n  //   //   <label htmlFor={id}>{children}</label>\n  //   // </div>\n  // );\n};\n","import React from 'react';\nimport styles from './ButtonGroup.module.css';\n\ninterface ButtonGroupProps {\n  children?: any;\n  toggle?: boolean;\n  className?: string;\n}\nexport const ButtonGroup = ({\n  children,\n  toggle,\n  className,\n}: ButtonGroupProps) => {\n  return <div className={`${styles.buttonGroup} ${className}`}>{children}</div>;\n};\n","import React from 'react';\nimport styles from './Navbar.module.css';\n\ninterface NavbarProps {\n  children?: any;\n  className?: string;\n}\nexport const Navbar = ({ children, className }: NavbarProps) => {\n  return <nav className={`${styles.navbar} ${className}`}>{children}</nav>;\n};\n","import React from 'react';\nimport styles from '../ScoreEditor.module.css';\n\ninterface DropdownProps {\n  children?: any;\n  variant?: string;\n  className?: string;\n  id?: string;\n  onChange?: (e: any) => void;\n}\nexport const Dropdown = ({\n  children,\n  variant,\n  className,\n  id,\n  onChange,\n}: DropdownProps) => {\n  return (\n    <form className={styles.form} onChange={onChange}>\n      <select id={id} className={className}>\n        {children}\n      </select>\n    </form>\n  );\n};\n","import convert from 'xml-js';\nimport React from 'react';\nconst ReactDomServer = require('react-dom/server');\n\nexport const xmlString = (measures: any) => {\n  return `\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE score-partwise PUBLIC \"-//Recordare//DTD MusicXML 2.0 Partwise//EN\" \"http://www.musicxml.org/dtds/partwise.dtd\">\n\n<score-partwise version=\"2.0\">\n    <movement-title>Test</movement-title>\n    <identification>\n        <encoding>\n            <software>Caesura</software>\n            <encoding-date>2020-10-10</encoding-date>\n            <supports attribute=\"new-system\" element=\"print\" type=\"yes\" value=\"yes\"/>\n            <supports attribute=\"new-page\" element=\"print\" type=\"yes\" value=\"yes\"/>\n        </encoding>\n    </identification>\n    <defaults>\n        <scaling>\n            <millimeters>7.540625</millimeters>\n            <tenths>40</tenths>\n        </scaling>\n        <page-layout>\n            <page-height>1481</page-height>\n            <page-width>1145</page-width>\n            <page-margins type=\"both\">\n                <left-margin>58</left-margin>\n                <right-margin>58</right-margin>\n                <top-margin>66</top-margin>\n                <bottom-margin>66</bottom-margin>\n            </page-margins>\n        </page-layout>\n        <system-layout>\n            <system-margins>\n                <left-margin>225</left-margin>\n                <right-margin>0</right-margin>\n            </system-margins>\n            <system-distance>96</system-distance>\n            <top-system-distance>96</top-system-distance>\n        </system-layout>\n        <staff-layout>\n            <staff-distance>0</staff-distance>\n        </staff-layout>\n    </defaults>\n    <part-list>\n        <score-part id=\"P1\">\n            <part-name>Grand Piano</part-name>\n        </score-part>\n    </part-list>\n    <part id=\"P1\">\n      ${measures}\n    </part>\n</score-partwise>\n`;\n};\n\nexport interface Pitch {\n  step: string;\n  alter: string;\n  octave: number;\n}\n\nexport interface Notations {\n  tied?: 'start' | 'stop';\n}\n\nexport interface Measure {\n  index: number;\n  notes: Array<Note>;\n  attributes: Attributes | null;\n}\n\nexport interface Note {\n  pitch: Pitch;\n  duration: number;\n  type: string;\n  chord?: boolean;\n  rest?: boolean;\n  dotted?: boolean;\n  beam?: 'begin' | 'end';\n  tie?: 'start' | 'stop';\n  notations?: Notations;\n}\n\nexport interface Key {\n  fifths: number;\n  mode: string;\n}\nexport interface Time {\n  beats: number;\n  beatType: number;\n}\nexport interface Clef {\n  sign: string;\n  line: number;\n}\n\nexport interface Attributes {\n  divisions: number;\n  key: Key;\n  time: Time;\n  clef: Clef;\n}\n\nconst Measure = (props) => React.createElement('measure', props);\nconst Print = (props) => React.createElement('print', props);\nconst SystemLayout = (props) => React.createElement('system-layout', props);\nconst SystemMargins = (props) => React.createElement('system-margins', props);\nconst LeftMargin = (props) => React.createElement('left-margin', props);\nconst RightMargin = (props) => React.createElement('right-margin', props);\nconst TopSystemDistance = (props) =>\n  React.createElement('top-system-distance', props);\nconst MeasureNumbering = (props) =>\n  React.createElement('measure-numbering', props);\n\nexport const measureToXML = (measure: Measure) => {\n  return ReactDomServer.renderToStaticMarkup(\n    <Measure number={measure.index}>\n      {/* <Print page-number=\"1\">\n        <SystemLayout>\n          <SystemMargins>\n            <LeftMargin>225</LeftMargin>\n            <RightMargin>0</RightMargin>\n          </SystemMargins>\n          <TopSystemDistance>96</TopSystemDistance>\n        </SystemLayout>\n        <MeasureNumbering>none</MeasureNumbering>\n      </Print> */}\n      {measure.attributes && attributesToXML(measure.attributes)}\n      {measure.notes.map((note) => noteToXML(note))}\n    </Measure>\n  );\n};\n\nconst Note = (props) => React.createElement('note', props);\nconst Chord = (props) => React.createElement('chord', props);\nconst Pitch = (props) => React.createElement('pitch', props);\nconst Step = (props) => React.createElement('step', props);\nconst Alter = (props) => React.createElement('alter', props);\nconst Octave = (props) => React.createElement('octave', props);\nconst Duration = (props) => React.createElement('duration', props);\nconst Voice = (props) => React.createElement('voice', props);\nconst Type = (props) => React.createElement('type', props);\nconst Tie = (props) => React.createElement('tie', props);\nconst Stem = (props) => React.createElement('stem', props);\nconst Staff = (props) => React.createElement('staff', props);\n\nconst Notations = (props) => React.createElement('notations', props);\nconst Dot = (props) => React.createElement('dot', props);\nconst Rest = (props) => React.createElement('rest', props);\nconst Tied = (props) => React.createElement('tied', props);\nconst Beam = (props) => React.createElement('beam', props);\n\nexport const noteToXML = (note: Note) => {\n  return (\n    <Note>\n      {note.chord && <Chord />}\n      <Pitch>\n        <Step>{note.pitch.step}</Step>\n        <Alter>{note.pitch.alter}</Alter>\n        <Octave>{note.pitch.octave}</Octave>\n      </Pitch>\n      {note.rest && <Rest />}\n      <Duration>{note.duration}</Duration>\n      <Voice>1</Voice>\n      {note.dotted && <Dot />}\n      <Type>{note.type}</Type>\n      <Beam number=\"1\">{note.beam}</Beam>\n      <Tie type={note.tie} />\n      <Stem>up</Stem>\n      <Staff>1</Staff>\n      {note.notations ? (\n        <Notations>\n          <Tied orientation=\"over\" type={note.notations.tied} />\n        </Notations>\n      ) : null}\n    </Note>\n  );\n};\n\nconst Attributes = (props) => React.createElement('attributes', props);\nconst Divisions = (props) => React.createElement('divisions', props);\nconst Key = (props) => React.createElement('key', props);\nconst Fifths = (props) => React.createElement('fifths', props);\nconst Mode = (props) => React.createElement('mode', props);\nconst Time = (props) => React.createElement('time', props);\nconst Beats = (props) => React.createElement('beats', props);\nconst BeatType = (props) => React.createElement('beat-type', props);\nconst Clef = (props) => React.createElement('clef', props);\nconst Sign = (props) => React.createElement('sign', props);\nconst Line = (props) => React.createElement('line', props);\n\nexport const attributesToXML = (attributes) => {\n  return (\n    <Attributes>\n      <Divisions>{attributes.divisions}</Divisions>\n      <Key>\n        <Fifths>{attributes.key.fifths}</Fifths>\n        <Mode>{attributes.key.mode}</Mode>\n      </Key>\n      <Time>\n        <Beats>{attributes.time.beats}</Beats>\n        <BeatType>{attributes.time.beatType}</BeatType>\n      </Time>\n      <Clef>\n        <Sign>{attributes.clef.sign}</Sign>\n        <Line>{attributes.clef.line}</Line>\n      </Clef>\n    </Attributes>\n  );\n};\n\nconst xmlDurationToVFMap = {\n  maxima: null,\n  long: null,\n  breve: null,\n  whole: 'w',\n  half: 'h',\n  quarter: 'q',\n  eighth: '8',\n  '16th': '16',\n  '32nd': '32',\n  '64th': '64',\n  '128th': '128',\n  '256th': '256',\n  '512th': '512',\n  '1024th': '1024',\n};\n\nexport const xmlDurationToVF = (xmlDuration, isRest = false) => {\n  let restAddition = isRest ? 'r' : '';\n  const vfDuration = xmlDurationToVFMap[xmlDuration] + restAddition;\n  if (!vfDuration) {\n    throw new Error(`Note duration ${xmlDuration} wasn't found or unsupported`);\n  }\n  return vfDuration;\n};\n\nconst xmlFifthsToKeyMap = {\n  '-7': 'Cb',\n  '-6': 'Gb',\n  '-5': 'Db',\n  '-4': 'Ab',\n  '-3': 'Eb',\n  '-2': 'Bb',\n  '-1': 'F',\n  '0': 'C',\n  '1': 'G',\n  '2': 'D',\n  '3': 'A',\n  '4': 'E',\n  '5': 'B',\n  '6': 'F#',\n  '7': 'C#',\n};\nexport const xmlFifthsToKey = (xmlFifths) => {\n  return xmlFifthsToKeyMap[xmlFifths];\n};\nexport const xmlKeyToFifths = (xmlKey) => {\n  const key = Object.keys(xmlFifthsToKeyMap).find(\n    (k) => xmlFifthsToKeyMap[k] === xmlKey\n  );\n  return parseInt(key);\n};\n\nexport const getAccidental = {\n  '-7': 'bbbbbbb',\n  '-6': 'bbbbbb',\n  '-5': 'bbbbb',\n  '-4': 'bbbb',\n  '-3': 'bbb',\n  '-2': 'bb',\n  '-1': 'b',\n  '0': '',\n  '1': '#',\n  '2': '##',\n  '3': '###',\n  '4': '####',\n  '5': '#####',\n  '6': '######',\n  '7': '#######',\n};\n\nconst xmlSignToClefMap = {\n  G: 'treble',\n  F: 'bass',\n};\n\nexport const xmlSignToClef = (xmlSign) => {\n  return xmlSignToClefMap[xmlSign];\n};\n\nexport const xmlMeasureToJS = (measure) => {\n  const measuresArray = measure && measure.length ? measure : [measure];\n\n  const measureObjs = measuresArray.map((m) => {\n    const note = m && m['note'];\n    if (!note) {\n      return {\n        index: m._attributes.number,\n        attributes: m &&\n          m.attributes && {\n            clef: m.attributes.clef.sign._text,\n            keySignature: m.attributes.key.fifths._text,\n            beats: m.attributes.time.beats._text,\n            beatType: m.attributes.time['beat-type']._text,\n          },\n      };\n    }\n\n    const notes = note && note.length ? note : [note];\n    return {\n      index: m._attributes.number,\n      attributes: m &&\n        m.attributes && {\n          clef: m.attributes.clef.sign._text,\n          keySignature: m.attributes.key.fifths._text,\n          beats: m.attributes.time.beats._text,\n          beatType: m.attributes.time['beat-type']._text,\n        },\n      note:\n        notes &&\n        notes.map((note) => {\n          return {\n            chord: note.chord ? true : false,\n            pitch: note.pitch.step._text + `/${note.pitch.octave._text}`,\n            rest: note.rest ? true : false,\n            type: note.type._text,\n            alter: note.pitch.alter && note.pitch.alter._text,\n            dotted: note.dot ? true : false,\n            beam: note.beam && note.beam._text,\n            tie: note.tie && note.tie._attributes && note.tie._attributes.type,\n          };\n        }),\n    };\n  });\n  return measureObjs;\n};\n\nexport const musicXMLToJS = (xml) => {\n  if (xml) {\n    try {\n      const result = convert.xml2js(xml, { compact: true });\n      if (result && result['score-partwise']) {\n        const partwise = result['score-partwise'];\n        const part = partwise && partwise['part'];\n        const partList = partwise && partwise['part-list'];\n        const scorePart = partList && partList['score-part'];\n        const partName = scorePart && scorePart['part-name'];\n\n        const movementTitle = partwise && partwise['movement-title'];\n        const measure = part && part['measure'];\n        return {\n          partWise: {\n            defaults: 'Not Supported Yet!',\n            identification: 'Not Supported Yet!',\n            movementTitle: movementTitle._text,\n            partList: {\n              scorePart: {\n                id: scorePart._attributes && scorePart._attributes.id,\n                partName: partName._text,\n              },\n            },\n            part: {\n              id: part._attributes && part._attributes.id,\n              measure: xmlMeasureToJS(measure),\n            },\n            version: partwise._attributes && partwise._attributes.version,\n          },\n        };\n      }\n    } catch (e) {\n      throw e;\n    }\n  }\n};\n\n// const measures = xml.measures.map((measure) => {\n//   return {\n//     index: measure.index,\n//     notes:\n//       measure.notes &&\n//       measure.notes.map((note) => {\n//         return {\n//           pitch: note.pitch.step._text + `/${note.pitch.octave._text}`,\n//           duration: xmlDurationToVF[note.type._text],\n//           alter: note.pitch.alter._text,\n//           dotted: note.dot ? true : false,\n//           beam: note.beam._text,\n//           tie: note.tie._attributes && note.tie._attributes.type,\n//         };\n//       }),\n//     attributes: measure &&\n//       measure.attributes && {\n//         clef: xmlSignToClef[measure.attributes.clef.sign._text],\n//         keySignature: xmlFifthsToKey[measure.attributes.key.fifths._text],\n//         beats: measure.attributes.time.beats._text,\n//         beatType: measure.attributes.time[\"beat-type\"]._text,\n//       },\n//   };\n// });\n","import React from 'react';\nimport { ToggleButton } from './ToggleButton';\nimport styles from './NoteButton.module.css';\n\nconst NoteText = ({ children }) => {\n  return <span>{children}</span>;\n};\n\n// Note glyphs are unicode, taken from http://www.unicode.org/charts/PDF/U1D100.pdf\nexport const NoteButton = ({\n  noteType,\n  onClick,\n  current,\n  isRest,\n  className = '',\n  id = '',\n}) => {\n  let glyph;\n  switch (noteType) {\n    case 'whole':\n      glyph = isRest ? <NoteText>𝄻</NoteText> : <NoteText>𝅝</NoteText>;\n      break;\n    case 'half':\n      glyph = isRest ? <NoteText>𝄼</NoteText> : <NoteText>𝅗𝅥</NoteText>;\n      break;\n    case 'quarter':\n      glyph = isRest ? <NoteText>𝄽</NoteText> : <NoteText>𝅘𝅥</NoteText>;\n      break;\n    case 'eighth':\n      glyph = isRest ? <NoteText>𝄾</NoteText> : <NoteText>𝅘𝅥𝅮</NoteText>;\n      break;\n    case '16th':\n      glyph = isRest ? <NoteText>𝄿</NoteText> : <NoteText>𝅘𝅥𝅯</NoteText>;\n      break;\n    case '32nd':\n      glyph = isRest ? <NoteText>𝅀</NoteText> : <NoteText>𝅘𝅥𝅰</NoteText>;\n      break;\n    case '64th':\n      glyph = isRest ? <NoteText>𝅁</NoteText> : <NoteText>𝅘𝅥𝅱</NoteText>;\n      break;\n    case '128th':\n      glyph = isRest ? <NoteText>𝅂</NoteText> : <NoteText>𝅘𝅥𝅲</NoteText>;\n      break;\n  }\n  return (\n    <ToggleButton\n      checked={current === noteType}\n      onClick={onClick}\n      className={className}\n      id={`noteButton-${noteType}`}\n    >\n      <span className={styles.noteButton}>{glyph}</span>\n    </ToggleButton>\n  );\n};\n","export const Notes = [\n  { note: \"C0\", alt: null },\n  { note: \"C#0\", alt: \"Db0\" },\n  { note: \"D0\", alt: null },\n  { note: \"D#0\", alt: \"Eb0\" },\n  { note: \"E0\", alt: null },\n  { note: \"F0\", alt: null },\n  { note: \"F#0\", alt: \"Gb0\" },\n  { note: \"G0\", alt: null },\n  { note: \"G#0\", alt: \"Ab0\" },\n  { note: \"A0\", alt: null },\n  { note: \"A#0\", alt: \"Bb0\" },\n  { note: \"B0\", alt: null },\n  { note: \"C1\", alt: null },\n  { note: \"C#1\", alt: \"Db1\" },\n  { note: \"D1\", alt: null },\n  { note: \"D#1\", alt: \"Eb1\" },\n  { note: \"E1\", alt: null },\n  { note: \"F1\", alt: null },\n  { note: \"F#1\", alt: \"Gb1\" },\n  { note: \"G1\", alt: null },\n  { note: \"G#1\", alt: \"Ab1\" },\n  { note: \"A1\", alt: null },\n  { note: \"A#1\", alt: \"Bb1\" },\n  { note: \"B1\", alt: null },\n  { note: \"C2\", alt: null },\n  { note: \"C#2\", alt: \"Db2\" },\n  { note: \"D2\", alt: null },\n  { note: \"D#2\", alt: \"Eb2\" },\n  { note: \"E2\", alt: null },\n  { note: \"F2\", alt: null },\n  { note: \"F#2\", alt: \"Gb2\" },\n  { note: \"G2\", alt: null },\n  { note: \"G#2\", alt: \"Ab2\" },\n  { note: \"A2\", alt: null },\n  { note: \"A#2\", alt: \"Bb2\" },\n  { note: \"B2\", alt: null },\n  { note: \"C3\", alt: null },\n  { note: \"C#3\", alt: \"Db3\" },\n  { note: \"D3\", alt: null },\n  { note: \"D#3\", alt: \"Eb3\" },\n  { note: \"E3\", alt: null },\n  { note: \"F3\", alt: null },\n  { note: \"F#3\", alt: \"Gb3\" },\n  { note: \"G3\", alt: null },\n  { note: \"G#3\", alt: \"Ab3\" },\n  { note: \"A3\", alt: null },\n  { note: \"A#3\", alt: \"Bb3\" },\n  { note: \"B3\", alt: null },\n  { note: \"C4\", alt: null },\n  { note: \"C#4\", alt: \"Db4\" },\n  { note: \"D4\", alt: null },\n  { note: \"D#4\", alt: \"Eb4\" },\n  { note: \"E4\", alt: null },\n  { note: \"F4\", alt: null },\n  { note: \"F#4\", alt: \"Gb4\" },\n  { note: \"G4\", alt: null },\n  { note: \"G#4\", alt: \"Ab4\" },\n  { note: \"A4\", alt: null },\n  { note: \"A#4\", alt: \"Bb4\" },\n  { note: \"B4\", alt: null },\n  { note: \"C5\", alt: null },\n  { note: \"C#5\", alt: \"Db5\" },\n  { note: \"D5\", alt: null },\n  { note: \"D#5\", alt: \"Eb5\" },\n  { note: \"E5\", alt: null },\n  { note: \"F5\", alt: null },\n  { note: \"F#5\", alt: \"Gb5\" },\n  { note: \"G5\", alt: null },\n  { note: \"G#5\", alt: \"Ab5\" },\n  { note: \"A5\", alt: null },\n  { note: \"A#5\", alt: \"Bb5\" },\n  { note: \"B5\", alt: null },\n  { note: \"C6\", alt: null },\n  { note: \"C#6\", alt: \"Db6\" },\n  { note: \"D6\", alt: null },\n  { note: \"D#6\", alt: \"Eb6\" },\n  { note: \"E6\", alt: null },\n  { note: \"F6\", alt: null },\n  { note: \"F#6\", alt: \"Gb6\" },\n  { note: \"G6\", alt: null },\n  { note: \"G#6\", alt: \"Ab6\" },\n  { note: \"A6\", alt: null },\n  { note: \"A#6\", alt: \"Bb6\" },\n  { note: \"B6\", alt: null },\n];\n\nexport const VexNotes = [\n  { note: \"c/0\", alt: null },\n  { note: \"c#/0\", alt: \"db/0\" },\n  { note: \"d/0\", alt: null },\n  { note: \"d#/0\", alt: \"eb/0\" },\n  { note: \"e/0\", alt: null },\n  { note: \"f/0\", alt: null },\n  { note: \"f#/0\", alt: \"gb/0\" },\n  { note: \"g/0\", alt: null },\n  { note: \"g#/0\", alt: \"ab/0\" },\n  { note: \"a/0\", alt: null },\n  { note: \"a#/0\", alt: \"bb/0\" },\n  { note: \"b/0\", alt: null },\n  { note: \"c/1\", alt: null },\n  { note: \"c#/1\", alt: \"db/1\" },\n  { note: \"d/1\", alt: null },\n  { note: \"d#/1\", alt: \"eb/1\" },\n  { note: \"e/1\", alt: null },\n  { note: \"f/1\", alt: null },\n  { note: \"f#/1\", alt: \"gb/1\" },\n  { note: \"g/1\", alt: null },\n  { note: \"g#/1\", alt: \"ab/1\" },\n  { note: \"a/1\", alt: null },\n  { note: \"a#/1\", alt: \"bb/1\" },\n  { note: \"b/1\", alt: null },\n  { note: \"c/2\", alt: null },\n  { note: \"c#/2\", alt: \"db/2\" },\n  { note: \"d/2\", alt: null },\n  { note: \"d#/2\", alt: \"eb/2\" },\n  { note: \"e/2\", alt: null },\n  { note: \"f/2\", alt: null },\n  { note: \"f#/2\", alt: \"gb/2\" },\n  { note: \"g/2\", alt: null },\n  { note: \"g#/2\", alt: \"ab/2\" },\n  { note: \"a/2\", alt: null },\n  { note: \"a#/2\", alt: \"bb/2\" },\n  { note: \"b/2\", alt: null },\n  { note: \"c/3\", alt: null },\n  { note: \"c#/3\", alt: \"db/3\" },\n  { note: \"d/3\", alt: null },\n  { note: \"d#/3\", alt: \"eb/3\" },\n  { note: \"e/3\", alt: null },\n  { note: \"f/3\", alt: null },\n  { note: \"f#/3\", alt: \"gb/3\" },\n  { note: \"g/3\", alt: null },\n  { note: \"g#/3\", alt: \"ab/3\" },\n  { note: \"a/3\", alt: null },\n  { note: \"a#/3\", alt: \"bb/3\" },\n  { note: \"b/3\", alt: null },\n  { note: \"c/4\", alt: null },\n  { note: \"c#/4\", alt: \"db/4\" },\n  { note: \"d/4\", alt: null },\n  { note: \"d#/4\", alt: \"eb/4\" },\n  { note: \"e/4\", alt: null },\n  { note: \"f/4\", alt: null },\n  { note: \"f#/4\", alt: \"gb/4\" },\n  { note: \"g/4\", alt: null },\n  { note: \"g#/4\", alt: \"ab/4\" },\n  { note: \"a/4\", alt: null },\n  { note: \"a#/4\", alt: \"bb/4\" },\n  { note: \"b/4\", alt: null },\n  { note: \"c/5\", alt: null },\n  { note: \"c#/5\", alt: \"db/5\" },\n  { note: \"d/5\", alt: null },\n  { note: \"d#/5\", alt: \"eb/5\" },\n  { note: \"e/5\", alt: null },\n  { note: \"f/5\", alt: null },\n  { note: \"f#/5\", alt: \"gb/5\" },\n  { note: \"g/5\", alt: null },\n  { note: \"g#/5\", alt: \"ab/5\" },\n  { note: \"a/5\", alt: null },\n  { note: \"a#/5\", alt: \"bb/5\" },\n  { note: \"b/5\", alt: null },\n  { note: \"c/6\", alt: null },\n  { note: \"c#/6\", alt: \"db/6\" },\n  { note: \"d/6\", alt: null },\n  { note: \"d#/6\", alt: \"eb/6\" },\n  { note: \"e/6\", alt: null },\n  { note: \"f/6\", alt: null },\n  { note: \"f#/6\", alt: \"gb/6\" },\n  { note: \"g/6\", alt: null },\n  { note: \"g#/6\", alt: \"ab/6\" },\n  { note: \"a/6\", alt: null },\n  { note: \"a#/6\", alt: \"bb/6\" },\n  { note: \"b/6\", alt: null },\n];\n\nexport const newGNotes = [\n  { note: \"b/2\", alt: null },\n  { note: \"c/3\", alt: null },\n  { note: \"d/3\", alt: null },\n  { note: \"e/3\", alt: null },\n  { note: \"f/3\", alt: null },\n  { note: \"g/3\", alt: null },\n  { note: \"a/3\", alt: null },\n  { note: \"b/3\", alt: null },\n  { note: \"c/4\", alt: null },\n  { note: \"d/4\", alt: null },\n  { note: \"e/4\", alt: null },\n  { note: \"f/4\", alt: null },\n  { note: \"g/4\", alt: null },\n  { note: \"a/4\", alt: null },\n  { note: \"b/4\", alt: null },\n  { note: \"c/5\", alt: null },\n  { note: \"d/5\", alt: null },\n  { note: \"e/5\", alt: null },\n  { note: \"f/5\", alt: null },\n  { note: \"g/5\", alt: null },\n  { note: \"a/5\", alt: null },\n  { note: \"b/6\", alt: null },\n  { note: \"c/6\", alt: null },\n  { note: \"d/6\", alt: null },\n  { note: \"e/6\", alt: null },\n  { note: \"f/6\", alt: null },\n  { note: \"g/6\", alt: null },\n].reverse();\n\nexport const newFNotes = [\n  { note: \"c/1\", alt: null },\n  { note: \"d/1\", alt: null },\n  { note: \"e/1\", alt: null },\n  { note: \"f/1\", alt: null },\n  { note: \"g/1\", alt: null },\n  { note: \"a/1\", alt: null },\n  { note: \"b/1\", alt: null },\n  { note: \"c/2\", alt: null },\n  { note: \"d/2\", alt: null },\n  { note: \"e/2\", alt: null },\n  { note: \"f/2\", alt: null },\n  { note: \"g/2\", alt: null },\n  { note: \"a/2\", alt: null },\n  { note: \"b/2\", alt: null },\n  { note: \"c/3\", alt: null },\n  { note: \"d/3\", alt: null },\n  { note: \"e/3\", alt: null },\n  { note: \"f/3\", alt: null },\n  { note: \"g/3\", alt: null },\n  { note: \"a/3\", alt: null },\n  { note: \"b/3\", alt: null },\n  { note: \"c/4\", alt: null },\n  { note: \"d/4\", alt: null },\n  { note: \"e/4\", alt: null },\n  { note: \"f/4\", alt: null },\n  { note: \"g/4\", alt: null },\n  { note: \"a/4\", alt: null },\n  { note: \"b/4\", alt: null },\n].reverse();\n\nexport const noteToVex = (note) => {\n  const isNote = Notes.findIndex((n) => n.note === note);\n  const isAlt = Notes.findIndex((n) => n.alt === note);\n  if (isNote !== -1) {\n    return VexNotes[isNote].note;\n  }\n  if (isAlt !== -1) {\n    return VexNotes[isAlt].alt;\n  }\n};\n\nexport const Intervals = [\n  { name: \"P1\", alt: \"d2\" },\n  { name: \"m2\", alt: \"A1\" },\n  { name: \"M2\", alt: \"d3\" },\n  { name: \"m3\", alt: \"A2\" },\n  { name: \"M3\", alt: \"d4\" },\n  { name: \"P4\", alt: \"A3\" },\n  { name: \"d5\", alt: \"A4\" },\n  { name: \"P5\", alt: \"d6\" },\n  { name: \"m6\", alt: \"A5\" },\n  { name: \"M6\", alt: \"d7\" },\n  { name: \"m7\", alt: \"A6\" },\n  { name: \"M7\", alt: \"d8\" },\n  { name: \"P8\", alt: \"A7\" },\n];\n\nexport const IntervalNames = {\n  P1: \"Perfect Unison\",\n  m2: \"Minor Second\",\n  M2: \"Major Second\",\n  m3: \"Minor Third\",\n  M3: \"Major Third\",\n  P4: \"Perfect Fourth\",\n  d5: \"Diminished Fifth\",\n  P5: \"Perfect Fifth\",\n  m6: \"Minor Sixth\",\n  M6: \"Major Sixth\",\n  m7: \"Minor Seventh\",\n  M7: \"Major Seventh\",\n  P8: \"Perfect Octave\",\n};\n\nexport const majorKeys = [\n  \"C\",\n  \"F\",\n  \"Bb\",\n  \"Eb\",\n  \"Ab\",\n  \"Db\",\n  \"Gb\",\n  \"Cb\",\n  \"G\",\n  \"D\",\n  \"A\",\n  \"E\",\n  \"B\",\n  \"F#\",\n  \"C#\",\n];\nexport const minorKeys = [\n  \"Am\",\n  \"Dm\",\n  \"Gm\",\n  \"Cm\",\n  \"Fm\",\n  \"Bbm\",\n  \"Ebm\",\n  \"Abm\",\n  \"Em\",\n  \"Bm\",\n  \"F#m\",\n  \"C#m\",\n  \"G#m\",\n  \"D#m\",\n  \"A#m\",\n];\n\nexport const convertKey = (start) => {\n  switch (start) {\n    case \"C#\":\n      return \"Db\";\n    case \"D#\":\n      return \"Eb\";\n    case \"E#\":\n      return \"F\";\n    case \"G#\":\n      return \"Ab\";\n    case \"A#\":\n      return \"Bb\";\n  }\n  return start;\n};\n\nexport const getInterval = (start, end) => {\n  const startIndex = Notes.findIndex(\n    (n) => n.note === start || n.alt === start\n  );\n  const endIndex = Notes.findIndex((n) => n.note === end || n.alt === end);\n\n  // Unison case\n  if (endIndex === startIndex) {\n    return Intervals[0];\n  }\n\n  const intervalsWithoutUnison = Intervals.slice(1);\n  const intervalsWithoutOctave = Intervals.slice(0, Intervals.length - 1);\n\n  if (endIndex < startIndex) {\n    const oct = parseInt(end.slice(end.length - 1, end.length));\n    const endOctUp = end.slice(end, end.length - 1) + (oct + 1);\n    const endOctUpIndex = Notes.findIndex(\n      (n) => n.note === endOctUp || n.alt === endOctUp\n    );\n    // reverse interval lookup\n    const diff = endOctUpIndex - startIndex;\n    const repeated = new Array(diff).fill(intervalsWithoutOctave).flat();\n    const reversed = repeated.reverse();\n    return reversed[diff - 1];\n  }\n  const diff = endIndex - startIndex;\n  const repeated = new Array(diff).fill(intervalsWithoutUnison).flat();\n  return repeated[diff - 1];\n};\n\nexport const getIntervalName = (interval) => {\n  return IntervalNames[interval];\n};\n\nexport const noteToAlt = (note) => {\n  const isNote = Notes.find((n) => n.note === note);\n  const isAlt = Notes.find((n) => n.alt === note);\n  if (isNote && isNote.alt) {\n    return isNote.alt;\n  }\n  if (isAlt && isAlt.note) {\n    return isAlt.note;\n  }\n  return note;\n};\n\nexport const convertNoteDuration = (duration, dotted) => {\n  switch (duration) {\n    case \"w\":\n    case \"whole\":\n      return dotted ? \"1n.\" : \"1n\";\n    case \"h\":\n    case \"half\":\n      return dotted ? \"2n.\" : \"2n\";\n    case \"q\":\n    case \"quarter\":\n      return dotted ? \"4n.\" : \"4n\";\n    case \"8\":\n    case \"eighth\":\n      return dotted ? \"8n.\" : \"8n\";\n    case \"16\":\n    case \"16th\":\n      return dotted ? \"16n.\" : \"16n\";\n  }\n};\n\nexport const canBeamNote = (noteType) => {\n  if (noteType === \"eighth\" || noteType === \"16th\" || noteType === \"32nd\") {\n    return true;\n  }\n  return false;\n};\n\nconst doubleAccidentalNoteMap = {\n  \"A##\": \"B\",\n  \"B##\": \"C#\",\n  \"C##\": \"D\",\n  \"D##\": \"E\",\n  \"E##\": \"F#\",\n  \"F##\": \"G\",\n  \"G##\": \"A\",\n};\n\nexport const doubleAccidentalToNote = (note) => {\n  return doubleAccidentalNoteMap[note];\n};\n","export const majorScales = {\n  C: [\"c\", \"d\", \"e\", \"f\", \"g\", \"a\", \"b\"],\n  G: [\"g\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f#\"],\n  D: [\"d\", \"e\", \"f#\", \"g\", \"a\", \"b\", \"c#\"],\n  A: [\"a\", \"b\", \"c#\", \"d\", \"e\", \"f#\", \"g#\"],\n  E: [\"e\", \"f#\", \"g#\", \"a\", \"b\", \"c#\", \"d#\"],\n  B: [\"b\", \"c#\", \"d#\", \"e\", \"f#\", \"g#\", \"a#\"],\n  \"F#\": [\"f#\", \"g#\", \"a#\", \"b\", \"c#\", \"d#\", \"e\"],\n  \"C#\": [\"c#\", \"d#\", \"e\", \"f#\", \"g#\", \"a#\", \"b#\"],\n  F: [\"f\", \"g\", \"a\", \"bb\", \"c\", \"d\", \"e\"],\n  Bb: [\"bb\", \"c\", \"d\", \"eb\", \"f\", \"g\", \"a\"],\n  Eb: [\"eb\", \"f\", \"g\", \"ab\", \"bb\", \"c\", \"d\"],\n  Ab: [\"ab\", \"bb\", \"c\", \"db\", \"eb\", \"f\", \"g\"],\n  Db: [\"db\", \"eb\", \"f\", \"gb\", \"ab\", \"bb\", \"c\"],\n  Gb: [\"gb\", \"ab\", \"bb\", \"cb\", \"db\", \"eb\", \"f\"],\n  Cb: [\"c\", \"db\", \"eb\", \"fb\", \"gb\", \"ab\", \"bb\"],\n};\n\nexport const minorScales = {\n  Am: [\"c\", \"d\", \"e\", \"f\", \"g\", \"a\", \"b\"],\n  Em: [\"g\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f#\"],\n  Bm: [\"d\", \"e\", \"f#\", \"g\", \"a\", \"b\", \"c#\"],\n  \"F#m\": [\"a\", \"b\", \"c#\", \"d\", \"e\", \"f#\", \"g#\"],\n  \"C#m\": [\"e\", \"f#\", \"g#\", \"a\", \"b\", \"c#\", \"d#\"],\n  \"G#m\": [\"b\", \"c#\", \"d#\", \"e\", \"f#\", \"g#\", \"a#\"],\n  \"D#m\": [\"f#\", \"g#\", \"a#\", \"b\", \"c#\", \"d#\", \"e\"],\n  Dm: [\"f\", \"g\", \"a\", \"bb\", \"c\", \"d\", \"e\"],\n  Gm: [\"bb\", \"c\", \"d\", \"eb\", \"f\", \"g\", \"a\"],\n  Cm: [\"eb\", \"f\", \"g\", \"ab\", \"bb\", \"c\", \"d\"],\n  Fm: [\"ab\", \"bb\", \"c\", \"db\", \"eb\", \"f\", \"g\"],\n  Bbm: [\"db\", \"eb\", \"f\", \"gb\", \"ab\", \"bb\", \"c\"],\n  Ebm: [\"gb\", \"ab\", \"bb\", \"cb\", \"db\", \"eb\", \"f\"],\n};\n","import React, { useEffect, useState, useRef } from 'react';\nimport Vex from 'vexflow';\n\nimport { majorScales, minorScales } from './lib/scales';\nimport {\n  getAccidental,\n  xmlDurationToVF,\n  xmlFifthsToKey,\n  xmlKeyToFifths,\n  xmlSignToClef,\n} from './lib/musicxml';\nimport { newGNotes, newFNotes, VexNotes } from './lib/notes';\n\nconst VF = Vex.Flow;\nconst { Formatter, Renderer, Stave, StaveNote } = VF;\n\ninterface StaveWithVoice extends Vex.Flow.Stave {\n  voices: Array<Vex.Flow.Voice>;\n}\n\nfunction getCoords(e, svg, svgPt) {\n  svgPt.x = e.clientX;\n  svgPt.y = e.clientY;\n  const svgCoords = svgPt.matrixTransform(svg.getScreenCTM().inverse());\n  return { x: svgCoords.x, y: svgCoords.y };\n}\nfunction getCoordsInCanvas(e, canvas) {\n  const rect = canvas.getBoundingClientRect();\n  return {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top,\n  };\n}\n\nconst MusicXMLSheet = ({\n  id,\n  xml,\n  selectedNote = null,\n  setSelectedNote = null,\n  readOnly = false,\n  toggleReadOnly = null,\n  noteType = null,\n  appendNote = null,\n  accidental = null,\n  isRest = false,\n  children = null,\n  playNotesComponent = null,\n}) => {\n  const { partWise } = xml;\n  const { measure: measures } = partWise.part;\n\n  const [highlightIndex, setHightlightIndex] = useState({\n    measure: null,\n    note: null,\n  });\n  const [keySignature, setKeySignature] = useState(\n    xmlFifthsToKey(measures[0].attributes.keySignature)\n  );\n  const [newNote, setNewNote] = useState(null);\n  const [hoveringNote, setHoveringNote] = useState(null);\n\n  const [renderer, setRenderer] = useState(null);\n  const [context, setContext] = useState(null);\n  const [staves, setStaves] = useState([]);\n\n  const container = useRef<any>();\n  const formatter = new Vex.Flow.Formatter();\n\n  const clef = measures[0].attributes.clef;\n  const uiAvailableNotes = clef === 'G' ? newGNotes : newFNotes;\n\n  const handleClick = (e) => {\n    if (newNote) appendNote(newNote, accidental);\n    else if (hoveringNote) {\n      const first = hoveringNote.newNote.note.pitch;\n      const second = hoveringNote.hoveringNote.keys;\n      if (second.includes(first)) {\n        setSelectedNote({\n          measureIndex: hoveringNote.measureIndex,\n          noteIndex: hoveringNote.noteIndex,\n        });\n      } else {\n        appendNote(hoveringNote.newNote, accidental, hoveringNote);\n        setSelectedNote(null);\n      }\n    }\n    setNewNote(null);\n  };\n\n  const handleHover = (e) => {\n    if (context) {\n      const svgPoint = context.svg.createSVGPoint();\n\n      const coords = getCoords(e, context.svg, svgPoint);\n      // const coords = getCoordsInCanvas(e, context.canvas);\n      if (coords.x !== lastCoords.x && coords.y !== lastCoords.y) {\n        lastCoords = coords;\n        staves.forEach((stave: StaveWithVoice, index) => {\n          // @ts-ignore - typo in vexflow type defs\n          const bb = stave.getBoundingBox();\n          let staveKeySig;\n\n          // @ts-ignore - typo in vexflow type defs\n          if (stave && stave.getModifiers && stave.getModifiers()[4]) {\n            // @ts-ignore - typo in vexflow type defs\n            staveKeySig = stave.getModifiers()[4]['keySpec'];\n          } else {\n            staveKeySig = keySignature;\n          }\n          const scale = { ...majorScales, ...minorScales }[staveKeySig];\n          if (\n            coords.x > bb.x &&\n            coords.x < bb.x + bb.w &&\n            coords.y > bb.y &&\n            coords.y < bb.y + bb.h\n          ) {\n            const mouseY = coords.y - bb.y;\n            const mouseX = coords.x - bb.x;\n\n            const noteArea = Math.round(\n              mouseY / (stave.options.spacing_between_lines_px / 2)\n            );\n            const { note } = uiAvailableNotes[noteArea];\n            let alter = 0;\n            if (\n              !scale.includes(note.slice(0, note.length - 2)) &&\n              !isRest &&\n              accidental !== 'n'\n            ) {\n              const fifths = xmlKeyToFifths(staveKeySig);\n              if (fifths < 0) {\n                alter = -1;\n              } else if (fifths > 0) {\n                alter = 1;\n              }\n            }\n            const newNewNote = {\n              measure: index,\n              note: {\n                pitch: note.toUpperCase(),\n                type: noteType,\n                alter,\n                dotted: false,\n                beam: null,\n              },\n              clef: clef === 'G' ? 'treble' : 'bass',\n              x: mouseX,\n            };\n\n            let hoveringOverNote = false;\n            stave.voices &&\n              stave.voices.forEach((voice) => {\n                const ticks = voice.getTickables();\n                ticks.forEach((tick, tickIndex) => {\n                  const tickBB = tick.getBoundingBox();\n                  if (\n                    coords.x > tickBB.getX() &&\n                    coords.x < tickBB.getX() + tickBB.getW()\n                  ) {\n                    hoveringOverNote = true;\n                    setNewNote(null);\n                    setHoveringNote({\n                      measureIndex: index,\n                      hoveringNote: tick,\n                      newNote: newNewNote,\n                      noteIndex: tickIndex,\n                    });\n                  }\n                });\n              });\n            if (\n              !hoveringOverNote &&\n              noteArea >= 0 &&\n              noteArea < uiAvailableNotes.length\n            ) {\n              setNewNote(newNewNote);\n              setHoveringNote(null);\n            } else {\n            }\n          }\n        });\n      }\n    }\n  };\n\n  const handleMouseLeave = (e) => {\n    setNewNote(null);\n  };\n\n  // const svgPoint = context && context.svg.createSVGPoint();\n  let lastCoords = { x: 0, y: 0 };\n\n  const fifths = xmlKeyToFifths(keySignature);\n  const width = 160 + Math.abs(fifths) * 20;\n  const height = 120;\n  const padding = 10;\n  const measuresPerLine = 4;\n  const lines = Math.ceil(measures.length / measuresPerLine) - 1;\n  const lengths = measures.map((measure) => {\n    const length =\n      measure.note && measure.note.length ? measure.note.length : 0;\n    return width + length * 15;\n  });\n  const lineLengths = lengths.slice(0, measuresPerLine);\n\n  const containerWidth = lineLengths.reduce((accum, current) => {\n    return accum + current;\n  }, 0);\n\n  useEffect(() => {\n    if (!renderer && xml) {\n      setRenderer(new Renderer(container.current, Renderer.Backends.SVG));\n    } else if (renderer && xml && !context) {\n      if (!context) setContext(renderer.getContext());\n    }\n  });\n\n  useEffect(() => {\n    if (renderer && xml && context) {\n      renderer.resize(\n        containerWidth + padding,\n        // lines > 0 ? containerWidth / lines + 1 : containerWidth + padding,\n        height + height * lines\n      );\n\n      let newLineIndex = 0;\n      let measureCount = 0;\n      try {\n        context.clear();\n\n        let allStaves = [];\n\n        measures.forEach((measure, measureIndex) => {\n          const { note: notes } = measure;\n          let { attributes: newAttributes } = measure;\n          const notesLength = (notes && notes.length) || 0;\n          const prevMeasures = measures.slice(newLineIndex, measureIndex);\n          const prevLengths = prevMeasures.map((measure) => {\n            const length =\n              measure.note && measure.note.length ? measure.note.length : 0;\n            return width + length * 15;\n          });\n          const l = prevLengths.reduce((accum, current) => {\n            return accum + current;\n          }, 0);\n\n          let x = measureCount === 0 ? 0 : l;\n          let y = (newLineIndex / measuresPerLine) * height;\n\n          let stave = new VF.Stave(\n            x,\n            y,\n            width + notesLength * 15\n          ) as StaveWithVoice;\n\n          let attributes = measures[0].attributes;\n          if (measureCount === 0) {\n            newAttributes = attributes;\n          }\n          if (newAttributes) {\n            attributes = newAttributes;\n            const { clef, keySignature, beats, beatType } = attributes;\n            // Add a clef and time signature.\n            if (clef) {\n              stave\n                .addClef(xmlSignToClef(clef))\n                .addTimeSignature(`${beats}/${beatType}`);\n              const vfKeySig = xmlFifthsToKey(keySignature);\n              stave.setKeySignature(vfKeySig, vfKeySig);\n              setKeySignature(vfKeySig);\n            }\n          }\n\n          measureCount += 1;\n          if (measureCount === measuresPerLine) {\n            // new line!\n            measureCount = 0;\n            newLineIndex += measuresPerLine;\n          }\n          // Connect it to the rendering context and draw!\n          stave.setContext(context).draw();\n          allStaves.push(stave);\n\n          let beams = [];\n          let newBeam = [];\n\n          let ties = [];\n          let newTie = {};\n          let tieStarted = false;\n\n          let vexNotes = [];\n\n          const getNext = (current, noteIndex) => {\n            const next = notes[noteIndex + 1];\n            if (next && next.chord) {\n              return [current, ...getNext(next, noteIndex + 1)];\n            }\n            return [current];\n          };\n\n          if (notes) {\n            let selectIndex = 0;\n            notes.forEach((note, index, arr) => {\n              if (!note.chord) {\n                const next = getNext(note, index);\n\n                const sortedNext = next.sort((a, b) => {\n                  const aNoteIndex = VexNotes.findIndex(\n                    (item) =>\n                      item.note === a.pitch.toLowerCase() ||\n                      item.alt === a.pitch.toLowerCase()\n                  );\n                  const bNoteIndex = VexNotes.findIndex(\n                    (item) =>\n                      item.note === b.pitch.toLowerCase() ||\n                      item.alt === b.pitch.toLowerCase()\n                  );\n                  return aNoteIndex > bNoteIndex ? 1 : -1;\n                });\n\n                const pitches = sortedNext.map((note) => note.pitch);\n                let staveNote = new VF.StaveNote({\n                  clef: clef === 'G' ? 'treble' : 'bass',\n                  keys: pitches,\n                  duration: xmlDurationToVF(note.type, note.rest),\n                  auto_stem: !note.beam,\n                });\n\n                if (\n                  selectedNote &&\n                  measureIndex === selectedNote.measureIndex &&\n                  selectIndex === selectedNote.noteIndex\n                ) {\n                  staveNote.setStyle({\n                    fillStyle: '#2bcebb',\n                    strokeStyle: '#2bcebb',\n                  });\n                }\n                if (\n                  highlightIndex &&\n                  measure.index === highlightIndex.measure &&\n                  index === highlightIndex.note\n                ) {\n                  staveNote.setStyle({\n                    fillStyle: '#ce2cbd',\n                    strokeStyle: '#ce2cbd',\n                  });\n                }\n\n                const scale = { ...majorScales, ...minorScales }[\n                  xmlFifthsToKey(attributes.keySignature)\n                ];\n                const n = note.pitch\n                  .slice(0, note.pitch.length - 2)\n                  .toLowerCase();\n                const withAccidental = n + getAccidental[note.alter];\n\n                if (!scale.includes(withAccidental) && !note.rest) {\n                  const i = sortedNext.findIndex((item) => {\n                    return item.pitch === note.pitch;\n                  });\n                  if (note.alter > 0) {\n                    // TO-DO: multiple accidentals\n                    staveNote.addAccidental(i, new VF.Accidental('#'));\n                  } else if (note.alter < 0) {\n                    staveNote.addAccidental(i, new VF.Accidental('b'));\n                  } else {\n                    staveNote.addAccidental(i, new VF.Accidental('n'));\n                  }\n                }\n                if (note.dotted) {\n                  staveNote.addDot(0);\n                }\n                if (note.beam && note.beam === 'begin') {\n                  newBeam.push(staveNote);\n                }\n                if (\n                  (note.beam && note.beam === 'end') ||\n                  (note.beam &&\n                    note.beam === 'begin' &&\n                    index !== 0 &&\n                    index === notes.length - 1)\n                ) {\n                  newBeam.push(staveNote);\n                  beams.push(newBeam);\n                  newBeam = [];\n                }\n                if (note.tie && !tieStarted && note.tie === 'start') {\n                  newTie = { first_note: staveNote };\n                  tieStarted = true;\n                }\n                if (note.tie && note.tie === 'stop') {\n                  newTie = {\n                    ...newTie,\n                    last_note: staveNote,\n                  };\n                  ties.push(newTie);\n                  newTie = {};\n                  tieStarted = false;\n                }\n\n                vexNotes.push(staveNote);\n                selectIndex += 1;\n              }\n            });\n          }\n\n          if (vexNotes.length > 0) {\n            const voice = new Vex.Flow.Voice({\n              num_beats: attributes.beats,\n              beat_value: attributes.beatType,\n            }).setMode(Vex.Flow.Voice.Mode.SOFT);\n            voice.addTickables(vexNotes);\n            formatter.joinVoices([voice]).formatToStave([voice], stave, {\n              align_rests: true,\n              context: context,\n            });\n            const allTies = ties.map((tie) => {\n              return new VF.StaveTie({\n                first_note: tie.first_note,\n                last_note: tie.last_note,\n                first_indices: [0],\n                last_indices: [0],\n              });\n            });\n            const allBeams = beams.map((beamNotes) => {\n              return new VF.Beam(beamNotes);\n            });\n\n            voice.draw(context, stave);\n            allBeams.forEach(function (b) {\n              b.setContext(context).draw();\n            });\n            allTies.forEach(function (t) {\n              t.setContext(context).draw();\n            });\n\n            stave.voices = [voice];\n          }\n        });\n        setStaves(allStaves);\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  }, [measures, renderer, context, newNote, selectedNote, highlightIndex]);\n\n  useEffect(() => {\n    if (newNote) {\n      const stave = staves[newNote.measure];\n      let uiNote = new VF.StaveNote({\n        keys: [newNote.note.pitch],\n        duration: xmlDurationToVF(newNote.note.type, isRest),\n        auto_stem: true,\n        clef: newNote.clef,\n      });\n      uiNote.setStyle({\n        fillStyle: 'lightgrey',\n        strokeStyle: 'lightgrey',\n      });\n      const voice = new Vex.Flow.Voice({\n        num_beats: 4,\n        beat_value: 4,\n      }).setMode(Vex.Flow.Voice.Mode.SOFT);\n      voice.addTickables([uiNote]);\n      formatter.joinVoices([voice]).formatToStave([voice], stave, {\n        align_rests: true,\n        context: context,\n      });\n\n      // uiNote.preFormat();\n      uiNote.setXShift(\n        uiNote.getX() +\n          newNote.x -\n          (newNote.measure === 0 || newNote.measure % measuresPerLine === 0\n            ? Math.abs(fifths) * 15 + 80\n            : 25)\n      );\n      voice.draw(context, stave);\n    }\n  }, [newNote]);\n\n  const PlayNotes = playNotesComponent;\n\n  return (\n    <div>\n      {readOnly ? (\n        <div id={id} ref={container} />\n      ) : (\n        <div\n          id={id}\n          ref={container}\n          onClick={handleClick}\n          onMouseMove={handleHover}\n          onMouseLeave={handleMouseLeave}\n        />\n      )}\n      <div className=\"d-flex\">\n        {playNotesComponent && (\n          <PlayNotes\n            measures={measures}\n            setHightlightIndex={setHightlightIndex}\n            toggleReadOnly={toggleReadOnly}\n          />\n        )}\n        {children}\n      </div>\n    </div>\n  );\n};\n\nexport default MusicXMLSheet;\n","import React, { FunctionComponent, ReactElement, useState } from 'react';\nimport { Button } from './ui/Button';\nimport { ToggleButton } from './ui/ToggleButton';\nimport { ButtonGroup } from './ui/ButtonGroup';\nimport { Navbar } from './ui/Navbar';\nimport { Dropdown } from './ui/Dropdown';\n\nimport {\n  Key,\n  Measure,\n  Pitch,\n  Time,\n  Clef,\n  musicXMLToJS,\n  xmlString,\n  measureToXML,\n} from './lib/musicxml';\nimport { NoteButton } from './ui/NoteButton';\nimport { canBeamNote } from './lib/notes';\nimport MusicXMLSheet from './MusicXMLSheet';\nimport styles from './ScoreEditor.module.css';\n\nconst BackspaceIcon = () => {\n  return (\n    <svg\n      width=\"1em\"\n      height=\"1em\"\n      viewBox=\"0 0 16 16\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fill-rule=\"evenodd\"\n        d=\"M6.603 2h7.08a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-7.08a1 1 0 0 1-.76-.35L1 8l4.844-5.65A1 1 0 0 1 6.603 2zm7.08-1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1h7.08zM5.829 5.146a.5.5 0 0 0 0 .708L7.976 8l-2.147 2.146a.5.5 0 0 0 .707.708l2.147-2.147 2.146 2.147a.5.5 0 0 0 .707-.708L9.39 8l2.146-2.146a.5.5 0 0 0-.707-.708L8.683 7.293 6.536 5.146a.5.5 0 0 0-.707 0z\"\n      />\n    </svg>\n  );\n};\n\nconst PlusIcon = () => {\n  return (\n    <svg\n      width=\"1em\"\n      height=\"1em\"\n      viewBox=\"0 0 16 16\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fill-rule=\"evenodd\"\n        d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"\n      />\n    </svg>\n  );\n};\n\ninterface ScoreEditorProps {\n  readOnly?: boolean;\n  createScore?: Function;\n  createScoreLabel?: string;\n  notesCallback?: Function;\n  scoreCallback?: Function;\n  playNotesComponent?: ReactElement;\n}\n\nexport const ScoreEditor: FunctionComponent<ScoreEditorProps> = ({\n  readOnly = false,\n  createScore = null,\n  createScoreLabel = null,\n  notesCallback = null,\n  scoreCallback = null,\n  children = null,\n  playNotesComponent = null,\n}) => {\n  const [measures, setMeasures] = useState([\n    {\n      index: 0,\n      notes: [],\n      attributes: {\n        divisions: 2,\n        key: { fifths: 0, mode: 'major' } as Key,\n        time: { beats: 4, beatType: 4 } as Time,\n        clef: { sign: 'G', line: 2 } as Clef,\n      },\n    } as Measure,\n  ]);\n  const [currentMeasureIndex, setCurrentMeasureIndex] = useState(0);\n  const [selectedNote, setSelectedNote] = useState(null);\n\n  const [noteType, setNoteType] = useState('whole');\n  const [isRest, setIsRest] = useState(false);\n  const [accidental, setAccidental] = useState(null);\n  const [beam, setBeam] = useState(null);\n  const [dotted, setDotted] = useState(false);\n\n  const addMeasure = () => {\n    const newIndex = currentMeasureIndex + 1;\n    const newMeasure: Measure = {\n      index: newIndex,\n      notes: [],\n      attributes: null,\n      // attributes: {\n      //   divisions: 2,\n      //   key: { fifths: 0, mode: \"major\" } as Key,\n      //   time: { beats: 4, beatType: 4 } as Time,\n      //   clef: { sign: \"G\", line: 2 } as Clef,\n      // },\n    };\n    setMeasures([...measures, newMeasure]);\n    setCurrentMeasureIndex(newIndex);\n  };\n\n  const appendNote = (vfNote, accidental, appendTo = null) => {\n    const { note, measure: measureIndex } = vfNote;\n    if (note && note.pitch) {\n      let alter = note.alter;\n      if (accidental === '#') {\n        alter += 1;\n      }\n      if (accidental === 'b') {\n        alter += -1;\n      }\n      const newMeasures = measures.map((measure: Measure) => {\n        if (measure.index === measureIndex) {\n          if (appendTo) {\n            const newNote = {\n              chord: appendTo,\n              pitch: {\n                step: note.pitch[0],\n                alter,\n                octave: note.pitch[note.pitch.length - 1],\n              },\n              rest: isRest,\n              duration: 1,\n              dotted,\n              type: note.type,\n              beam,\n              // notations: { tied: false },\n            };\n            const newNotes = measure.notes;\n            let chordIndex = 0;\n            let i = 0;\n            while (chordIndex <= appendTo.noteIndex) {\n              if (!newNotes[i].chord) {\n                chordIndex += 1;\n              }\n              i++;\n            }\n            newNotes.splice(i + 1, 0, newNote);\n            return {\n              ...measure,\n              notes: newNotes,\n            };\n          }\n          // Question here is if chords need to be in note order -\n          // i.e. if your first note is say a G/4, then the second note of the chord\n          // is an E/4, should the order be G/4 -> E/4 or E/4 -> G/4 (since the E/4 is\n          // a lower note)\n          return {\n            ...measure,\n            notes: [\n              ...measure.notes,\n              {\n                chord: appendTo,\n                pitch: {\n                  step: note.pitch[0],\n                  alter,\n                  octave: note.pitch[note.pitch.length - 1],\n                },\n                rest: isRest,\n                duration: 1,\n                dotted,\n                type: note.type,\n                beam,\n                // notations: { tied: false },\n              },\n            ],\n          } as Measure;\n        }\n        return measure;\n      });\n      setMeasures(newMeasures);\n      setSelectedNote({\n        measureIndex: currentMeasureIndex,\n        noteIndex: newMeasures[currentMeasureIndex].notes.length - 1,\n      });\n      if (beam === 'end') {\n        setBeam(null);\n      }\n      if (notesCallback) {\n        notesCallback(\n          newMeasures[currentMeasureIndex].notes,\n          newMeasures[currentMeasureIndex].attributes.key\n        );\n      }\n    }\n  };\n\n  const removeNote = () => {\n    if (\n      selectedNote &&\n      measures[currentMeasureIndex] &&\n      measures[currentMeasureIndex].notes.length > 0\n    ) {\n      // TO-DO: here we really need a way to determine which note in a chord\n      // was selected. Currently we're passing a Vexflow Tick instance, which is the\n      // entire chord.\n      const note =\n        measures[selectedNote.measureIndex].notes[selectedNote.noteIndex];\n\n      const getNext = (current, noteIndex) => {\n        const next = measures[selectedNote.measureIndex].notes[noteIndex + 1];\n        if (next && next.chord) {\n          return [current, ...getNext(next, noteIndex + 1)];\n        }\n        return [current];\n      };\n      // if the note is the root note of a chord, it's chord prop will be null, but subsequent\n      // notes will have the chord prop to indicate it's part of a chord\n      // hence we get the next note in the chord, and set that to null to indicate it's the root\n      if (!note.chord) {\n        const nextNotes = getNext(note, selectedNote.noteIndex);\n        if (nextNotes.length > 1) {\n          nextNotes[1].chord = null;\n        }\n      }\n      const notesToRemove = [note];\n      setMeasures(\n        measures.map((measure, measureIndex) => {\n          if (measureIndex === selectedNote.measureIndex) {\n            return {\n              ...measure,\n              notes: measure.notes.filter((n) => {\n                return !notesToRemove.includes(n);\n              }),\n            };\n          }\n          return measure;\n        })\n      );\n      const newNoteIndex = measures[currentMeasureIndex].notes.length - 2;\n      if (newNoteIndex < 0) {\n        setSelectedNote(null);\n      } else {\n        setSelectedNote({\n          measureIndex: currentMeasureIndex,\n          noteIndex: newNoteIndex,\n        });\n      }\n    } else if (\n      measures[currentMeasureIndex] &&\n      measures[currentMeasureIndex].notes &&\n      measures[currentMeasureIndex].notes.length > 0\n    ) {\n      // Remove last/current measure if it's empty and no note is selected\n      const newNotes = measures[currentMeasureIndex].notes.slice(0, -1);\n      setMeasures(\n        measures.map((measure) => {\n          if (measure.index === currentMeasureIndex) {\n            return {\n              ...measure,\n              notes: newNotes,\n            };\n          }\n          return measure;\n        })\n      );\n      setSelectedNote({\n        measureIndex: currentMeasureIndex,\n        noteIndex: measures[currentMeasureIndex].notes.length - 2,\n      });\n    } else if (measures.length > 1) {\n      const newMeasures = measures;\n      newMeasures.splice(currentMeasureIndex, 1);\n      setMeasures(newMeasures);\n      setCurrentMeasureIndex(currentMeasureIndex - 1);\n    }\n  };\n\n  const updateClef = (e) => {\n    const newValue = e.target.value;\n    setMeasures(\n      measures.map((measure: Measure) => {\n        if (measure.index === 0) {\n          return {\n            ...measure,\n            attributes: {\n              ...attributes,\n              clef: {\n                sign: newValue,\n                line: attributes.clef.line,\n              },\n            },\n          } as Measure;\n        }\n        return measure;\n      })\n    );\n  };\n\n  const tieNote = () => {\n    setMeasures(\n      measures.map((measure, measureIndex) => {\n        if (measureIndex === selectedNote.measureIndex) {\n          return {\n            ...measure,\n            notes: measure.notes.map((note, index) => {\n              if (index === selectedNote.noteIndex) {\n                if (note.tie) {\n                  return { ...note, tie: null };\n                }\n                return { ...note, tie: 'start' };\n              } else if (index === selectedNote.noteIndex + 1) {\n                if (note.tie) {\n                  return { ...note, tie: null };\n                }\n                return { ...note, tie: 'stop' };\n              }\n              return note;\n            }),\n          };\n        }\n        return measure;\n      })\n    );\n  };\n\n  const xmlSheet = xmlString(measures.map((measure) => measureToXML(measure)));\n\n  const parsedXML = musicXMLToJS(xmlSheet);\n  if (scoreCallback) {\n    scoreCallback(parsedXML);\n  }\n\n  const currentMeasure = measures[currentMeasureIndex];\n\n  let attributes = currentMeasure && currentMeasure.attributes;\n  if (!attributes) {\n    attributes = measures[0].attributes;\n  }\n\n  let canTie = false;\n  if (selectedNote) {\n    const nextNote =\n      measures[selectedNote.measureIndex].notes[selectedNote.noteIndex + 1];\n    if (nextNote) {\n      const selected =\n        measures[selectedNote.measureIndex].notes[selectedNote.noteIndex];\n\n      if (\n        selected.pitch.step === nextNote.pitch.step &&\n        selected.pitch.octave === nextNote.pitch.octave\n      ) {\n        canTie = true;\n      }\n    }\n  }\n\n  return (\n    <div>\n      {!readOnly && (\n        <Navbar>\n          <Dropdown onChange={updateClef}>\n            <option key=\"clef-dropdown-0\">G</option>\n            <option key=\"clef-dropdown-1\">F</option>\n          </Dropdown>\n          <form className={`${styles.form}`}>\n            <input\n              type=\"number\"\n              aria-label=\"Beat\"\n              value={attributes && attributes.time.beats}\n              className={styles.timeInput}\n              style={{ textAlign: 'right' }}\n              onChange={(e) => {\n                setMeasures(\n                  measures.map((measure: Measure) => {\n                    if (measure.index === 0) {\n                      return {\n                        ...measure,\n                        attributes: {\n                          ...measure.attributes,\n                          time: {\n                            beats: parseInt(e.target.value),\n                            beatType: measure.attributes.time.beatType,\n                          },\n                        },\n                      } as Measure;\n                    }\n                    return measure;\n                  })\n                );\n              }}\n            />\n          </form>\n          <form className={`${styles.form}`}>\n            <input\n              type=\"number\"\n              aria-label=\"Time\"\n              value={attributes && attributes.time.beatType}\n              style={{ textAlign: 'left' }}\n              className={styles.timeInput}\n              onChange={(e) => {\n                setMeasures(\n                  measures.map((measure: Measure) => {\n                    if (measure.index === 0) {\n                      return {\n                        ...measure,\n                        attributes: {\n                          ...measure.attributes,\n                          time: {\n                            beatType: parseInt(e.target.value),\n                            beats: measure.attributes.time.beats,\n                          },\n                        },\n                      } as Measure;\n                    }\n                    return measure;\n                  })\n                );\n              }}\n            />\n          </form>\n          <form className={`${styles.form} ${styles.tooltip}`}>\n            <input\n              type=\"number\"\n              aria-label=\"Fifths\"\n              value={attributes && attributes.key.fifths}\n              onChange={(e) => {\n                setMeasures(\n                  measures.map((measure: Measure) => {\n                    if (measure.index === 0) {\n                      return {\n                        ...measure,\n                        attributes: {\n                          ...measure.attributes,\n                          key: {\n                            fifths: parseInt(e.target.value),\n                            mode: measure.attributes.key.mode,\n                          },\n                        },\n                      } as Measure;\n                    }\n                    return measure;\n                  })\n                );\n              }}\n            />\n          </form>\n          <ButtonGroup>\n            <ToggleButton\n              checked={accidental === '#'}\n              onClick={(e) => {\n                if (accidental !== '#') {\n                  setAccidental('#');\n                } else {\n                  setAccidental(null);\n                }\n              }}\n            >\n              ♯\n            </ToggleButton>\n            <ToggleButton\n              checked={accidental === 'b'}\n              onClick={(e) => {\n                if (accidental !== 'b') {\n                  setAccidental('b');\n                } else {\n                  setAccidental(null);\n                }\n              }}\n            >\n              ♭\n            </ToggleButton>\n            <ToggleButton\n              checked={accidental === 'n'}\n              onClick={(e) => {\n                if (accidental !== 'n') {\n                  setAccidental('n');\n                } else {\n                  setAccidental(null);\n                }\n              }}\n            >\n              ♮\n            </ToggleButton>\n          </ButtonGroup>\n          <ButtonGroup>\n            <ToggleButton\n              id=\"restToggleButton\"\n              checked={isRest}\n              onClick={() => {\n                setIsRest(true);\n              }}\n            >\n              rest\n            </ToggleButton>\n            <ToggleButton\n              id=\"noteToggleButton\"\n              checked={!isRest}\n              onClick={() => {\n                setIsRest(false);\n              }}\n            >\n              note\n            </ToggleButton>\n          </ButtonGroup>\n          <ButtonGroup>\n            <NoteButton\n              noteType=\"whole\"\n              current={noteType}\n              isRest={isRest}\n              onClick={() => setNoteType('whole')}\n            />\n            <NoteButton\n              noteType=\"half\"\n              current={noteType}\n              isRest={isRest}\n              onClick={() => setNoteType('half')}\n            />\n            <NoteButton\n              noteType=\"quarter\"\n              current={noteType}\n              isRest={isRest}\n              onClick={() => setNoteType('quarter')}\n            />\n            <NoteButton\n              noteType=\"eighth\"\n              current={noteType}\n              isRest={isRest}\n              onClick={() => setNoteType('eighth')}\n            />\n            <NoteButton\n              noteType=\"16th\"\n              current={noteType}\n              isRest={isRest}\n              onClick={() => setNoteType('16th')}\n            />\n            <NoteButton\n              noteType=\"32nd\"\n              current={noteType}\n              isRest={isRest}\n              onClick={() => setNoteType('32nd')}\n            />\n          </ButtonGroup>\n          <ButtonGroup>\n            <ToggleButton\n              id=\"dottedToggleButton\"\n              checked={dotted}\n              onClick={(e) => setDotted(!dotted)}\n            >\n              Dot\n            </ToggleButton>\n            <ToggleButton\n              id=\"beamToggleButton\"\n              disabled={!canBeamNote(noteType)}\n              checked={beam === 'begin' ? true : false}\n              onClick={(e) => {\n                if (beam === null) {\n                  setBeam('begin');\n                } else if (beam === 'begin') {\n                  setMeasures(\n                    measures.map((measure) => {\n                      if (measure.index === measures.length - 1) {\n                        return {\n                          ...measure,\n                          notes: measure.notes.map((note, index) => {\n                            if (index === measure.notes.length - 1) {\n                              return { ...note, beam: 'end' };\n                            }\n                            return note;\n                          }),\n                        };\n                      }\n                      return measure;\n                    })\n                  );\n                  setBeam(null);\n                }\n              }}\n            >\n              Beam\n            </ToggleButton>\n          </ButtonGroup>\n          <ButtonGroup>\n            <Button disabled={!canTie} id=\"tieButton\" onClick={tieNote}>\n              Tie\n            </Button>\n            <Button id=\"removeNoteButton\" onClick={removeNote}>\n              <BackspaceIcon />\n            </Button>\n            <Button id=\"addMeasureButton\" onClick={() => addMeasure()}>\n              <PlusIcon />\n            </Button>\n            {createScoreLabel && (\n              <Button className=\"ml-4\" onClick={() => createScore(xmlSheet)}>\n                {createScoreLabel}\n              </Button>\n            )}\n          </ButtonGroup>\n        </Navbar>\n      )}\n      <MusicXMLSheet\n        id=\"xmlsheet\"\n        xml={parsedXML}\n        noteType={noteType}\n        appendNote={appendNote}\n        accidental={accidental}\n        isRest={isRest}\n        selectedNote={selectedNote}\n        setSelectedNote={setSelectedNote}\n        playNotesComponent={playNotesComponent}\n      />\n      <div>{children}</div>\n    </div>\n  );\n};\n"],"names":["Button","children","disabled","className","id","onClick","styles","button","ToggleButton","checked","toggleButton","ButtonGroup","toggle","buttonGroup","Navbar","navbar","Dropdown","variant","onChange","form","ReactDomServer","require","xmlString","measures","Measure","props","React","createElement","measureToXML","measure","renderToStaticMarkup","index","attributes","attributesToXML","notes","map","note","noteToXML","Note","Chord","Pitch","Step","Alter","Octave","Duration","Voice","Type","Tie","Stem","Staff","Notations","Dot","Rest","Tied","Beam","chord","pitch","step","alter","octave","rest","duration","dotted","type","beam","tie","notations","tied","Attributes","Divisions","Key","Fifths","Mode","Time","Beats","BeatType","Clef","Sign","Line","divisions","key","fifths","mode","time","beats","beatType","clef","sign","line","xmlDurationToVFMap","maxima","breve","whole","half","quarter","eighth","xmlDurationToVF","xmlDuration","isRest","restAddition","vfDuration","Error","xmlFifthsToKeyMap","xmlFifthsToKey","xmlFifths","xmlKeyToFifths","xmlKey","Object","keys","find","k","parseInt","getAccidental","xmlSignToClefMap","G","F","xmlSignToClef","xmlSign","xmlMeasureToJS","measuresArray","length","measureObjs","m","_attributes","number","_text","keySignature","dot","musicXMLToJS","xml","result","convert","xml2js","compact","partwise","part","partList","scorePart","partName","movementTitle","partWise","defaults","identification","version","e","NoteText","NoteButton","noteType","current","glyph","noteButton","VexNotes","alt","newGNotes","reverse","newFNotes","canBeamNote","majorScales","C","D","A","E","B","Bb","Eb","Ab","Db","Gb","Cb","minorScales","Am","Em","Bm","Dm","Gm","Cm","Fm","Bbm","Ebm","VF","Vex","Flow","Renderer","getCoords","svg","svgPt","x","clientX","y","clientY","svgCoords","matrixTransform","getScreenCTM","inverse","MusicXMLSheet","selectedNote","setSelectedNote","readOnly","toggleReadOnly","appendNote","accidental","playNotesComponent","useState","highlightIndex","setHightlightIndex","setKeySignature","newNote","setNewNote","hoveringNote","setHoveringNote","renderer","setRenderer","context","setContext","staves","setStaves","container","useRef","formatter","Formatter","uiAvailableNotes","handleClick","first","second","includes","measureIndex","noteIndex","handleHover","svgPoint","createSVGPoint","coords","lastCoords","forEach","stave","bb","getBoundingBox","staveKeySig","getModifiers","scale","w","h","mouseY","mouseX","noteArea","Math","round","options","spacing_between_lines_px","slice","newNewNote","toUpperCase","hoveringOverNote","voices","voice","ticks","getTickables","tick","tickIndex","tickBB","getX","getW","handleMouseLeave","width","abs","height","padding","measuresPerLine","lines","ceil","lengths","lineLengths","containerWidth","reduce","accum","useEffect","Backends","SVG","getContext","resize","newLineIndex","measureCount","clear","allStaves","newAttributes","notesLength","prevMeasures","prevLengths","l","Stave","addClef","addTimeSignature","vfKeySig","draw","push","beams","newBeam","ties","newTie","tieStarted","vexNotes","getNext","next","selectIndex","arr","sortedNext","sort","a","b","aNoteIndex","findIndex","item","toLowerCase","bNoteIndex","pitches","staveNote","StaveNote","auto_stem","setStyle","fillStyle","strokeStyle","n","withAccidental","i","addAccidental","Accidental","addDot","first_note","last_note","num_beats","beat_value","setMode","SOFT","addTickables","joinVoices","formatToStave","align_rests","allTies","StaveTie","first_indices","last_indices","allBeams","beamNotes","t","console","error","uiNote","setXShift","PlayNotes","BackspaceIcon","PlusIcon","ScoreEditor","createScore","createScoreLabel","notesCallback","scoreCallback","setMeasures","currentMeasureIndex","setCurrentMeasureIndex","setNoteType","setIsRest","setAccidental","setBeam","setDotted","addMeasure","newIndex","newMeasure","vfNote","appendTo","newMeasures","newNotes","chordIndex","splice","removeNote","nextNotes","notesToRemove","filter","newNoteIndex","updateClef","newValue","target","value","tieNote","xmlSheet","parsedXML","currentMeasure","canTie","nextNote","selected","timeInput","textAlign","tooltip"],"mappings":"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"}