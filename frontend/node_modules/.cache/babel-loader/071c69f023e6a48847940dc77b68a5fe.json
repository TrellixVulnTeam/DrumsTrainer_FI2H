{"ast":null,"code":"//    abc_voice_element.js: Definition of the VoiceElement class.\n//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen\n//\n//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n//    documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation\n//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and\n//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n//    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n//    NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n/*global module */\nvar svgNS = \"http://www.w3.org/2000/svg\";\n\nfunction Svg(wrapper) {\n  this.svg = createSvg();\n  wrapper.appendChild(this.svg);\n}\n\nSvg.prototype.clear = function () {\n  if (this.svg) {\n    var wrapper = this.svg.parentNode;\n    this.svg = createSvg();\n\n    if (wrapper) {\n      // TODO-PER: If the wrapper is not present, then the underlying div was pulled out from under this instance. It's possible that is still useful (for creating the music off page?)\n      wrapper.innerHTML = \"\";\n      wrapper.appendChild(this.svg);\n    }\n  }\n};\n\nSvg.prototype.setTitle = function (title) {\n  var titleEl = document.createElement(\"title\");\n  var titleNode = document.createTextNode(title);\n  titleEl.appendChild(titleNode);\n  this.svg.insertBefore(titleEl, this.svg.firstChild);\n};\n\nSvg.prototype.setResponsiveWidth = function (w, h) {\n  // this technique is from: http://thenewcode.com/744/Make-SVG-Responsive, thx to https://github.com/iantresman\n  this.svg.setAttribute(\"viewBox\", \"0 0 \" + w + \" \" + h);\n  this.svg.setAttribute(\"preserveAspectRatio\", \"xMinYMin meet\");\n  this.svg.removeAttribute(\"height\");\n  this.svg.removeAttribute(\"width\");\n  this.svg.style['display'] = \"inline-block\";\n  this.svg.style['position'] = \"absolute\";\n  this.svg.style['top'] = \"0\";\n  this.svg.style['left'] = \"0\";\n\n  if (this.svg.parentNode) {\n    var cls = this.svg.parentNode.getAttribute(\"class\");\n    if (!cls) this.svg.parentNode.setAttribute(\"class\", \"abcjs-container\");else if (cls.indexOf(\"abcjs-container\") < 0) this.svg.parentNode.setAttribute(\"class\", cls + \" abcjs-container\");\n    this.svg.parentNode.style['display'] = \"inline-block\";\n    this.svg.parentNode.style['position'] = \"relative\";\n    this.svg.parentNode.style['width'] = \"100%\"; // PER: I changed the padding from 100% to this through trial and error.\n    // The example was using a square image, but this music might be either wider or taller.\n\n    var padding = h / w * 100;\n    this.svg.parentNode.style['padding-bottom'] = padding + \"%\";\n    this.svg.parentNode.style['vertical-align'] = \"middle\";\n    this.svg.parentNode.style['overflow'] = \"hidden\";\n  }\n};\n\nSvg.prototype.setSize = function (w, h) {\n  this.svg.setAttribute('width', w);\n  this.svg.setAttribute('height', h); // TODO-PER: Is this hack still needed?\n  // Correct for IE problem in calculating height\n  // var isIE = /*@cc_on!@*/false;//IE detector\n  // if (isIE) {\n  // \tthis.paper.canvas.parentNode.style.width = w + \"px\";\n  // \tthis.paper.canvas.parentNode.style.height = \"\" + h + \"px\";\n  // } else\n  // \tthis.paper.canvas.parentNode.setAttribute(\"style\", \"width:\" + w + \"px\");\n};\n\nSvg.prototype.setScale = function (scale) {\n  if (scale !== 1) {\n    this.svg.style.transform = \"scale(\" + scale + \",\" + scale + \")\";\n    this.svg.style['-ms-transform'] = \"scale(\" + scale + \",\" + scale + \")\";\n    this.svg.style['-webkit-transform'] = \"scale(\" + scale + \",\" + scale + \")\";\n    this.svg.style['transform-origin'] = \"0 0\";\n    this.svg.style['-ms-transform-origin-x'] = \"0\";\n    this.svg.style['-ms-transform-origin-y'] = \"0\";\n    this.svg.style['-webkit-transform-origin-x'] = \"0\";\n    this.svg.style['-webkit-transform-origin-y'] = \"0\";\n  } else {\n    this.svg.style.transform = \"\";\n    this.svg.style['-ms-transform'] = \"\";\n    this.svg.style['-webkit-transform'] = \"\";\n  }\n};\n\nSvg.prototype.setParentStyles = function (attr) {\n  // This is needed to get the size right when there is scaling involved.\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      if (this.svg.parentNode) this.svg.parentNode.style[key] = attr[key];\n    }\n  } // This is the last thing that gets called, so delete the temporary SVG if one was created\n\n\n  if (this.dummySvg) {\n    var body = document.querySelector('body');\n    body.removeChild(this.dummySvg);\n    this.dummySvg = null;\n  }\n};\n\nSvg.prototype.rect = function (attr) {\n  var el = document.createElementNS(svgNS, \"rect\");\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      var tmp = \"\" + attr[key];\n      if (tmp.indexOf(\"NaN\") >= 0) debugger;\n      el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n\n  this.append(el);\n  return el;\n};\n\nSvg.prototype.text = function (text, attr, target) {\n  var el = document.createElementNS(svgNS, 'text');\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      el.setAttribute(key, attr[key]);\n    }\n  }\n\n  var lines = (\"\" + text).split(\"\\n\");\n\n  for (var i = 0; i < lines.length; i++) {\n    var line = document.createElementNS(svgNS, 'tspan');\n    line.textContent = lines[i];\n    line.setAttribute(\"x\", attr.x ? attr.x : 0);\n    if (i !== 0) line.setAttribute(\"dy\", \"1.2em\");\n    el.appendChild(line);\n  }\n\n  if (target) target.appendChild(el);else this.append(el);\n  return el;\n};\n\nSvg.prototype.guessWidth = function (text, attr) {\n  var svg = this.createDummySvg();\n  var el = this.text(text, attr, svg);\n  var size;\n\n  try {\n    size = el.getBBox();\n    if (isNaN(size.height) || !size.height) // TODO-PER: I don't think this can happen unless there isn't a browser at all.\n      size = {\n        width: attr['font-size'] / 2,\n        height: attr['font-size'] + 2\n      }; // Just a wild guess.\n    else size = {\n        width: size.width,\n        height: size.height\n      };\n  } catch (ex) {\n    size = {\n      width: attr['font-size'] / 2,\n      height: attr['font-size'] + 2\n    }; // Just a wild guess.\n  }\n\n  svg.removeChild(el);\n  return size;\n};\n\nSvg.prototype.createDummySvg = function () {\n  if (!this.dummySvg) {\n    this.dummySvg = createSvg();\n    var styles = [\"display: block !important;\", \"height: 1px;\", \"width: 1px;\", \"position: absolute;\"];\n    this.dummySvg.setAttribute('style', styles.join(\"\"));\n    var body = document.querySelector('body');\n    body.appendChild(this.dummySvg);\n  }\n\n  return this.dummySvg;\n};\n\nSvg.prototype.getTextSize = function (text, attr, el) {\n  if (typeof text === 'number') text = '' + text;\n  if (!text || text.match(/^\\s+$/)) return {\n    width: 0,\n    height: 0\n  };\n  var removeLater = !el;\n  if (!el) el = this.text(text, attr);\n  var size;\n\n  try {\n    size = el.getBBox();\n    if (isNaN(size.height) || !size.height) size = this.guessWidth(text, attr);else size = {\n      width: size.width,\n      height: size.height\n    };\n  } catch (ex) {\n    size = this.guessWidth(text, attr);\n  }\n\n  if (removeLater) {\n    if (this.currentGroup) this.currentGroup.removeChild(el);else this.svg.removeChild(el);\n  }\n\n  return size;\n};\n\nSvg.prototype.openGroup = function (options) {\n  options = options ? options : {};\n  var el = document.createElementNS(svgNS, \"g\");\n  if (options.prepend) this.svg.insertBefore(el, this.svg.firstChild);else this.svg.appendChild(el);\n  this.currentGroup = el;\n  return el;\n};\n\nSvg.prototype.closeGroup = function () {\n  var g = this.currentGroup;\n  this.currentGroup = null;\n  return g;\n};\n\nSvg.prototype.path = function (attr) {\n  var el = document.createElementNS(svgNS, \"path\");\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      if (key === 'path') el.setAttributeNS(null, 'd', attr.path);else el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n\n  this.append(el);\n  return el;\n};\n\nSvg.prototype.pathToBack = function (attr) {\n  var el = document.createElementNS(svgNS, \"path\");\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      if (key === 'path') el.setAttributeNS(null, 'd', attr.path);else el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n\n  this.prepend(el);\n  return el;\n};\n\nSvg.prototype.append = function (el) {\n  if (this.currentGroup) this.currentGroup.appendChild(el);else this.svg.appendChild(el);\n};\n\nSvg.prototype.prepend = function (el) {\n  // The entire group is prepended, so don't prepend the individual elements.\n  if (this.currentGroup) this.currentGroup.appendChild(el);else this.svg.insertBefore(el, this.svg.firstChild);\n};\n\nSvg.prototype.setAttributeOnElement = function (el, attr) {\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n};\n\nfunction createSvg() {\n  var svg = document.createElementNS(svgNS, \"svg\");\n  svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n  svg.setAttribute('role', 'img'); // for accessibility\n\n  return svg;\n}\n\nmodule.exports = Svg;","map":{"version":3,"sources":["/home/elad/Desktop/Repos/drums-trainer/frontend/node_modules/react-sheet-music/node_modules/abcjs/src/write/svg.js"],"names":["svgNS","Svg","wrapper","svg","createSvg","appendChild","prototype","clear","parentNode","innerHTML","setTitle","title","titleEl","document","createElement","titleNode","createTextNode","insertBefore","firstChild","setResponsiveWidth","w","h","setAttribute","removeAttribute","style","cls","getAttribute","indexOf","padding","setSize","setScale","scale","transform","setParentStyles","attr","key","hasOwnProperty","dummySvg","body","querySelector","removeChild","rect","el","createElementNS","tmp","setAttributeNS","append","text","target","lines","split","i","length","line","textContent","x","guessWidth","createDummySvg","size","getBBox","isNaN","height","width","ex","styles","join","getTextSize","match","removeLater","currentGroup","openGroup","options","prepend","closeGroup","g","path","pathToBack","setAttributeOnElement","module","exports"],"mappings":"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","sourcesContent":["//    abc_voice_element.js: Definition of the VoiceElement class.\n//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen\n//\n//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n//    documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation\n//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and\n//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n//    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n//    NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n/*global module */\n\nvar svgNS = \"http://www.w3.org/2000/svg\";\n\nfunction Svg(wrapper) {\n\tthis.svg = createSvg();\n\twrapper.appendChild(this.svg);\n}\n\nSvg.prototype.clear = function() {\n\tif (this.svg) {\n\t\tvar wrapper = this.svg.parentNode;\n\t\tthis.svg = createSvg();\n\t\tif (wrapper) {\n\t\t\t// TODO-PER: If the wrapper is not present, then the underlying div was pulled out from under this instance. It's possible that is still useful (for creating the music off page?)\n\t\t\twrapper.innerHTML = \"\";\n\t\t\twrapper.appendChild(this.svg);\n\t\t}\n\t}\n};\n\nSvg.prototype.setTitle = function(title) {\n\tvar titleEl = document.createElement(\"title\");\n\tvar titleNode = document.createTextNode(title);\n\ttitleEl.appendChild(titleNode);\n\tthis.svg.insertBefore(titleEl, this.svg.firstChild);\n};\n\nSvg.prototype.setResponsiveWidth = function(w, h) {\n\t// this technique is from: http://thenewcode.com/744/Make-SVG-Responsive, thx to https://github.com/iantresman\n\tthis.svg.setAttribute(\"viewBox\", \"0 0 \" + w + \" \" + h);\n\tthis.svg.setAttribute(\"preserveAspectRatio\", \"xMinYMin meet\");\n\tthis.svg.removeAttribute(\"height\");\n\tthis.svg.removeAttribute(\"width\");\n\tthis.svg.style['display'] = \"inline-block\";\n\tthis.svg.style['position'] = \"absolute\";\n\tthis.svg.style['top'] = \"0\";\n\tthis.svg.style['left'] = \"0\";\n\n\tif (this.svg.parentNode) {\n\t\tvar cls = this.svg.parentNode.getAttribute(\"class\");\n\t\tif (!cls)\n\t\t\tthis.svg.parentNode.setAttribute(\"class\", \"abcjs-container\");\n\t\telse if (cls.indexOf(\"abcjs-container\") < 0)\n\t\t\tthis.svg.parentNode.setAttribute(\"class\", cls + \" abcjs-container\");\n\t\tthis.svg.parentNode.style['display'] = \"inline-block\";\n\t\tthis.svg.parentNode.style['position'] = \"relative\";\n\t\tthis.svg.parentNode.style['width'] = \"100%\";\n\t\t// PER: I changed the padding from 100% to this through trial and error.\n\t\t// The example was using a square image, but this music might be either wider or taller.\n\t\tvar padding = h / w * 100;\n\t\tthis.svg.parentNode.style['padding-bottom'] = padding + \"%\";\n\t\tthis.svg.parentNode.style['vertical-align'] = \"middle\";\n\t\tthis.svg.parentNode.style['overflow'] = \"hidden\";\n\t}\n};\n\nSvg.prototype.setSize = function(w, h) {\n\tthis.svg.setAttribute('width', w);\n\tthis.svg.setAttribute('height', h);\n\t// TODO-PER: Is this hack still needed?\n\t// Correct for IE problem in calculating height\n\t// var isIE = /*@cc_on!@*/false;//IE detector\n\t// if (isIE) {\n\t// \tthis.paper.canvas.parentNode.style.width = w + \"px\";\n\t// \tthis.paper.canvas.parentNode.style.height = \"\" + h + \"px\";\n\t// } else\n\t// \tthis.paper.canvas.parentNode.setAttribute(\"style\", \"width:\" + w + \"px\");\n};\n\nSvg.prototype.setScale = function(scale) {\n\tif (scale !== 1) {\n\t\tthis.svg.style.transform = \"scale(\"+scale+\",\"+scale+\")\";\n\t\tthis.svg.style['-ms-transform'] = \"scale(\"+scale+\",\"+scale+\")\";\n\t\tthis.svg.style['-webkit-transform'] = \"scale(\"+scale+\",\"+scale+\")\";\n\t\tthis.svg.style['transform-origin'] = \"0 0\";\n\t\tthis.svg.style['-ms-transform-origin-x'] = \"0\";\n\t\tthis.svg.style['-ms-transform-origin-y'] = \"0\";\n\t\tthis.svg.style['-webkit-transform-origin-x'] = \"0\";\n\t\tthis.svg.style['-webkit-transform-origin-y'] = \"0\";\n\t} else {\n\t\tthis.svg.style.transform = \"\";\n\t\tthis.svg.style['-ms-transform'] = \"\";\n\t\tthis.svg.style['-webkit-transform'] = \"\";\n\t}\n};\n\nSvg.prototype.setParentStyles = function(attr) {\n\t// This is needed to get the size right when there is scaling involved.\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tif (this.svg.parentNode)\n\t\t\t\tthis.svg.parentNode.style[key] = attr[key];\n\t\t}\n\t}\n\t// This is the last thing that gets called, so delete the temporary SVG if one was created\n\tif (this.dummySvg) {\n\t\tvar body = document.querySelector('body');\n\t\tbody.removeChild(this.dummySvg);\n\t\tthis.dummySvg = null;\n\t}\n\n};\n\nSvg.prototype.rect = function(attr) {\n\tvar el = document.createElementNS(svgNS, \"rect\");\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tvar tmp = \"\" + attr[key];\n\t\t\tif (tmp.indexOf(\"NaN\") >= 0)\n\t\t\t\tdebugger;\n\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n\tthis.append(el);\n\treturn el;\n};\n\nSvg.prototype.text = function(text, attr, target) {\n\tvar el = document.createElementNS(svgNS, 'text');\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tel.setAttribute(key, attr[key]);\n\t\t}\n\t}\n\tvar lines = (\"\"+text).split(\"\\n\");\n\tfor (var i = 0; i < lines.length; i++) {\n\t\tvar line = document.createElementNS(svgNS, 'tspan');\n\t\tline.textContent = lines[i];\n\t\tline.setAttribute(\"x\", attr.x ? attr.x : 0);\n\t\tif (i !== 0)\n\t\t\tline.setAttribute(\"dy\", \"1.2em\");\n\t\tel.appendChild(line);\n\t}\n\tif (target)\n\t\ttarget.appendChild(el);\n\telse\n\t\tthis.append(el);\n\treturn el;\n};\n\nSvg.prototype.guessWidth = function(text, attr) {\n\tvar svg = this.createDummySvg();\n\tvar el = this.text(text, attr, svg);\n\tvar size;\n\ttry {\n\t\tsize  = el.getBBox();\n\t\tif (isNaN(size.height) || !size.height) // TODO-PER: I don't think this can happen unless there isn't a browser at all.\n\t\t\tsize = { width: attr['font-size']/2, height: attr['font-size'] + 2 }; // Just a wild guess.\n\t\telse\n\t\t\tsize = {width: size.width, height: size.height};\n\t} catch (ex) {\n\t\tsize = { width: attr['font-size']/2, height: attr['font-size'] + 2 }; // Just a wild guess.\n\t}\n\tsvg.removeChild(el);\n\treturn size;\n};\n\nSvg.prototype.createDummySvg = function() {\n\tif (!this.dummySvg) {\n\t\tthis.dummySvg = createSvg();\n\t\tvar styles = [\n\t\t\t\"display: block !important;\",\n\t\t\t\"height: 1px;\",\n\t\t\t\"width: 1px;\",\n\t\t\t\"position: absolute;\"\n\t\t];\n\t\tthis.dummySvg.setAttribute('style', styles.join(\"\"));\n\t\tvar body = document.querySelector('body');\n\t\tbody.appendChild(this.dummySvg);\n\t}\n\n\treturn this.dummySvg;\n};\n\nSvg.prototype.getTextSize = function(text, attr, el) {\n\tif (typeof text === 'number')\n\t\ttext = ''+text;\n\tif (!text || text.match(/^\\s+$/))\n\t\treturn { width: 0, height: 0 };\n\tvar removeLater = !el;\n\tif (!el)\n\t\tel = this.text(text, attr);\n\tvar size;\n\ttry {\n\t\tsize  = el.getBBox();\n\t\tif (isNaN(size.height) || !size.height)\n\t\t\tsize = this.guessWidth(text, attr);\n\t\telse\n\t\t\tsize = {width: size.width, height: size.height};\n\t} catch (ex) {\n\t\tsize = this.guessWidth(text, attr);\n\t}\n\tif (removeLater) {\n\t\tif (this.currentGroup)\n\t\t\tthis.currentGroup.removeChild(el);\n\t\telse\n\t\t\tthis.svg.removeChild(el);\n\t}\n\treturn size;\n};\n\nSvg.prototype.openGroup = function(options) {\n\toptions = options ? options : {};\n\tvar el = document.createElementNS(svgNS, \"g\");\n\tif (options.prepend)\n\t\tthis.svg.insertBefore(el, this.svg.firstChild);\n\telse\n\t\tthis.svg.appendChild(el);\n\tthis.currentGroup = el;\n\treturn el;\n};\n\nSvg.prototype.closeGroup = function() {\n\tvar g = this.currentGroup;\n\tthis.currentGroup = null;\n\treturn g;\n};\n\nSvg.prototype.path = function(attr) {\n\tvar el = document.createElementNS(svgNS, \"path\");\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tif (key === 'path')\n\t\t\t\tel.setAttributeNS(null, 'd', attr.path);\n\t\t\telse\n\t\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n\tthis.append(el);\n\treturn el;\n};\n\nSvg.prototype.pathToBack = function(attr) {\n\tvar el = document.createElementNS(svgNS, \"path\");\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tif (key === 'path')\n\t\t\t\tel.setAttributeNS(null, 'd', attr.path);\n\t\t\telse\n\t\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n\tthis.prepend(el);\n\treturn el;\n};\n\nSvg.prototype.append = function(el) {\n\tif (this.currentGroup)\n\t\tthis.currentGroup.appendChild(el);\n\telse\n\t\tthis.svg.appendChild(el);\n};\n\nSvg.prototype.prepend = function(el) {\n\t// The entire group is prepended, so don't prepend the individual elements.\n\tif (this.currentGroup)\n\t\tthis.currentGroup.appendChild(el);\n\telse\n\t\tthis.svg.insertBefore(el, this.svg.firstChild);\n};\n\nSvg.prototype.setAttributeOnElement = function(el, attr) {\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n};\n\nfunction createSvg() {\n\tvar svg = document.createElementNS(svgNS, \"svg\");\n\tsvg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n\tsvg.setAttribute('role', 'img');    // for accessibility\n\treturn svg;\n}\n\n\nmodule.exports = Svg;\n"]},"metadata":{},"sourceType":"script"}